#include "network_evaluate_gil.h"

static const int structure [4][2] = {{6, 16},{16, 16},{16, 16},{16, 3}};
static float output_0[16];
static float output_1[16];
static float output_2[16];
static float output_3[3];
static const float mlp_0_weight[6][16] = {{-0.36207833886146545,0.09779434651136398,1.0378127098083496,0.1530182808637619,-0.1898445338010788,-0.1640886813402176,0.2814503312110901,-0.06979157775640488,0.05323132127523422,0.05578339844942093,-0.7388554215431213,0.5280634164810181,-0.026107223704457283,-0.28361403942108154,0.09827055037021637,0.7071300745010376},{-0.7667756080627441,-0.10829227417707443,-0.36992987990379333,-0.2851952612400055,0.2948338985443115,-0.4748455882072449,1.3759530782699585,0.4116543233394623,0.0730058029294014,0.3065676689147949,0.36450305581092834,-0.8808004856109619,0.4216282367706299,-0.41080981492996216,-0.5326092839241028,-0.03965360298752785},{-0.7861182689666748,-0.18482236564159393,-1.314818024635315,1.1748536825180054,0.19075998663902283,0.7098785638809204,-0.30483928322792053,0.05711963400244713,0.0186817217618227,1.0240150690078735,0.2279973030090332,-0.5759372115135193,1.1677364110946655,1.0220566987991333,0.38417544960975647,-1.188374638557434},{-0.14730465412139893,-0.9500712752342224,0.002514843363314867,-0.671664297580719,-0.9182072877883911,-0.2195097953081131,0.4215036928653717,-0.6743291020393372,0.8663671016693115,0.6086565256118774,-0.29798224568367004,-0.1899368166923523,-0.658618688583374,0.9879162311553955,0.6872411966323853,-0.29277658462524414},{1.6900619268417358,-0.18434776365756989,-1.5353128910064697,0.22241386771202087,-0.2011205554008484,-0.5269647240638733,0.11176314204931259,0.17221812903881073,-0.3315097689628601,0.6395670175552368,-0.625571072101593,1.6354830265045166,0.24730037152767181,-1.1081879138946533,-1.3628182411193848,-1.4407272338867188},{-1.4209458827972412,-0.08453495055437088,1.5157827138900757,0.9623692631721497,-1.455499529838562,0.49769842624664307,-0.9331345558166504,0.6013680696487427,-0.07464566081762314,0.00315971695818007,2.7631020545959473,-2.6951587200164795,0.5292965769767761,-1.8716604709625244,1.3626176118850708,-2.754322052001953}};
static const float mlp_2_weight[16][16] = {{0.6946990489959717,-0.16135866940021515,0.546333909034729,-0.03969799727201462,-0.3103674054145813,-0.2921817898750305,0.13084617257118225,0.6183295249938965,-0.49902817606925964,0.3238815665245056,0.9171633124351501,0.4348348081111908,-0.07692553848028183,-0.22174033522605896,-0.2110600471496582,0.22061023116111755},{-0.8610812425613403,-0.4095210134983063,0.18834680318832397,-1.1540204286575317,-0.2683655917644501,-0.30457445979118347,0.7471387386322021,-0.0006518488517031074,0.5431537628173828,0.6166108846664429,0.9649119973182678,-0.1244475468993187,-0.587131917476654,0.12146984785795212,0.9680797457695007,-0.3237919509410858},{-0.2177789807319641,0.2936755418777466,-0.08676285296678543,0.16030184924602509,2.8620965480804443,-0.37907424569129944,0.17988881468772888,-0.20745886862277985,-0.3352747857570648,-0.1565641611814499,-0.18980364501476288,-0.13842307031154633,-0.046510517597198486,1.5193464756011963,-0.04358537867665291,0.1269437074661255},{-0.6223030686378479,0.26792407035827637,-0.42299509048461914,-0.20281070470809937,-0.9592123031616211,-0.6101309061050415,0.2894454598426819,-0.49730128049850464,0.12303562462329865,-0.04113372415304184,0.5870310068130493,-0.7260921597480774,-0.37795472145080566,0.3080398440361023,1.012477159500122,0.44065234065055847},{0.2637134790420532,-0.2879943549633026,0.4605141878128052,-0.1495809704065323,0.29906758666038513,0.5279334187507629,0.4874670207500458,-0.3056946396827698,0.32074570655822754,0.05206197872757912,0.899286150932312,-0.3810073435306549,-0.10903941839933395,0.011013347655534744,0.16838900744915009,0.10697083920240402},{0.09800196439027786,0.053007934242486954,0.03141787648200989,-0.5445295572280884,0.8327117562294006,1.0261566638946533,0.0003020285221282393,-0.5373035669326782,0.769951343536377,-0.0225136186927557,0.07232090085744858,0.05325160548090935,0.08227775245904922,-0.4444587230682373,0.39438462257385254,0.21343809366226196},{0.05874566361308098,0.07437445968389511,0.1639212667942047,0.1385076940059662,1.429136872291565,-0.38032016158103943,0.20396548509597778,0.5862419009208679,-0.3597806394100189,0.27121323347091675,-0.18196538090705872,0.19255107641220093,-0.2125658243894577,-0.44656020402908325,-0.18068934977054596,0.08942330628633499},{0.38557735085487366,-0.2131054401397705,0.2376427948474884,-0.187284454703331,-1.381405234336853,0.15058299899101257,0.12033376842737198,0.010814085602760315,0.5168299674987793,0.38162171840667725,0.6413018107414246,-0.3030721843242645,-0.11210018396377563,-0.11719664931297302,0.47616270184516907,0.31341156363487244},{-0.009998558089137077,0.19868941605091095,-0.25076723098754883,0.5282381176948547,0.9735303521156311,0.14055708050727844,-0.13469144701957703,0.08388408273458481,-0.468644917011261,-0.30597859621047974,-0.7851781845092773,0.10829056799411774,0.41828641295433044,0.19945888221263885,-0.5208790898323059,0.04400634765625},{0.6411176323890686,0.6457658410072327,-0.34610849618911743,1.2674808502197266,-0.3639479875564575,-0.9479090571403503,-0.4132751524448395,-0.5789456367492676,-0.9596263766288757,-0.32189834117889404,0.018466075882315636,-0.2863709032535553,0.1544935405254364,0.3344820439815521,-0.08912304043769836,0.5237690210342407},{0.20152005553245544,-0.3535245954990387,0.32861921191215515,0.010891919955611229,-1.973954677581787,-0.024027785286307335,-0.26062482595443726,0.13842391967773438,-0.17758895456790924,0.40008285641670227,0.38084638118743896,0.025441747158765793,0.035725004971027374,-0.9070000648498535,-0.09527181088924408,0.22271102666854858},{0.10926171392202377,0.3649691939353943,-0.36232444643974304,-0.14744196832180023,1.4979400634765625,0.4037373661994934,0.12649524211883545,-0.4103446304798126,0.14608816802501678,-0.5886006951332092,0.20974741876125336,-0.07350170612335205,-0.07682038843631744,0.9445066452026367,0.12931565940380096,-0.26881733536720276},{0.31058478355407715,0.357918918132782,-0.16576313972473145,0.10851819813251495,-1.3825255632400513,-0.15092475712299347,0.1869019865989685,-0.39862316846847534,0.2674380838871002,0.16405341029167175,0.5787692070007324,-0.23936910927295685,-0.30859386920928955,-0.570531964302063,0.6957672238349915,0.39226412773132324},{-0.17419986426830292,-0.11209114640951157,-0.23108313977718353,0.4378819465637207,-0.5175517201423645,0.3198675811290741,-0.08651293814182281,-0.5197463631629944,-0.15367980301380157,-0.4210890829563141,-0.03516264632344246,-0.0024944257456809282,0.3193415701389313,-0.7331261038780212,0.24383066594600677,0.08534856885671616},{-0.09263166785240173,-0.09885911643505096,0.06414638459682465,0.15678419172763824,0.37580758333206177,-0.16679494082927704,-0.7861235737800598,-0.328164279460907,-0.5544248223304749,-0.15608178079128265,-1.425235629081726,-0.041713278740644455,-0.13961641490459442,0.16932173073291779,-1.3542574644088745,0.5155127048492432},{-0.31947067379951477,-0.21326777338981628,0.38851895928382874,-0.3517025113105774,2.2219014167785645,-0.8881992697715759,0.11817356944084167,0.13081224262714386,-0.5985747575759888,0.5450128316879272,-0.10202667117118835,0.07375121861696243,-0.014828357845544815,0.14554287493228912,0.5376524329185486,-0.06529810279607773}};
static const float mlp_4_weight[16][16] = {{-0.009600764140486717,-0.2439582794904709,-0.23798944056034088,0.1974092274904251,-0.26957955956459045,-0.38936713337898254,-0.030752407386898994,0.12250225991010666,0.19213947653770447,0.12741759419441223,0.33181485533714294,-0.26615938544273376,0.12775836884975433,0.011302949860692024,0.3711819350719452,0.2696024179458618},{-0.20234940946102142,0.19728127121925354,0.01924624666571617,-0.042430318892002106,-0.2759220600128174,-0.0728725865483284,-0.0849008783698082,-0.6386091709136963,-1.0234425067901611,0.037403665482997894,-0.06089158356189728,-0.1194034293293953,0.47499674558639526,0.37974458932876587,0.04955991357564926,-0.19256137311458588},{0.4137594699859619,-0.24653470516204834,0.17028896510601044,-0.4327634871006012,0.3944368362426758,0.027285849675536156,-0.2863394618034363,0.3581935465335846,1.1669178009033203,0.06471956521272659,0.3963136374950409,-0.03671369329094887,-0.11726739257574081,-0.36524340510368347,0.28312280774116516,0.03521077707409859},{-0.5377090573310852,-0.14589667320251465,0.09591905772686005,-0.2116858810186386,-0.23003627359867096,-0.8967556953430176,-0.21585698425769806,-0.27381274104118347,0.28667962551116943,0.5148735642433167,0.006685273256152868,-0.06613356620073318,0.7840181589126587,0.8648735284805298,-0.19559407234191895,-0.09719112515449524},{-0.013446822762489319,0.3205704391002655,0.09249014407396317,0.39679497480392456,0.11755261570215225,0.08224813640117645,-0.3975871503353119,-0.34858179092407227,-0.22251605987548828,0.1672663539648056,0.020323380827903748,-0.0476059690117836,0.4735260307788849,-0.23162052035331726,-0.3832356929779053,-0.3370814919471741},{-0.5639243125915527,-0.020405588671565056,-0.0851532593369484,1.318769931793213,-0.23116400837898254,-0.05036430060863495,0.5237808227539062,-0.10917296260595322,0.26624077558517456,-0.6483031511306763,-0.4113731384277344,0.5424280762672424,0.28972432017326355,0.06374355405569077,-0.4111308157444,0.1638801246881485},{0.0516032949090004,-0.10789743065834045,-0.4063186049461365,0.13383464515209198,-0.038064491003751755,0.3810613453388214,0.04027419909834862,0.2504492998123169,-0.5995201468467712,-0.2899720072746277,-0.010375707410275936,0.4503117799758911,0.25012314319610596,-0.4457138776779175,0.13638293743133545,0.22266215085983276},{-0.8177393674850464,0.37766361236572266,-1.1547307968139648,-1.1454405784606934,1.2511838674545288,-1.2193031311035156,-0.7884013056755066,0.3748616576194763,1.245947003364563,0.9755346179008484,0.13413666188716888,-0.2870650291442871,-1.2639471292495728,-0.4688209593296051,0.8271454572677612,-0.08970047533512115},{0.10457883775234222,0.29326796531677246,-0.16706733405590057,0.9690659642219543,0.18312081694602966,0.14794230461120605,0.260092556476593,-0.09584729373455048,0.21997381746768951,-0.3843946158885956,-0.22433626651763916,0.370557576417923,-0.13737192749977112,0.03439589589834213,-0.06691265106201172,-0.08932337164878845},{0.6884623765945435,0.25046855211257935,0.35179245471954346,-0.47621890902519226,0.40184247493743896,0.22888295352458954,-0.49269288778305054,0.3215087354183197,1.2570481300354004,0.2398756891489029,0.3311227858066559,0.15080156922340393,-0.15842291712760925,-0.3800651729106903,-0.22641175985336304,-0.26588040590286255},{0.37010684609413147,-0.04313710704445839,0.4414169490337372,0.09443802386522293,-0.6082228422164917,0.07871150970458984,-0.06369306147098541,0.24120080471038818,0.9673303961753845,-0.0009138945606537163,-0.0021852529607713223,0.5049681067466736,0.6969549655914307,-0.022209297865629196,-0.2822636067867279,-0.3392695188522339},{-0.5828830599784851,0.6829376220703125,-0.5127730369567871,-0.40429553389549255,0.8183398246765137,-0.2929900288581848,-0.3035982549190521,0.5559034943580627,1.1138944625854492,0.5778083205223083,0.12008462846279144,-0.6034237742424011,-0.9104048609733582,0.2944612503051758,0.13624821603298187,-0.5993282794952393},{-0.3146668076515198,0.16919593513011932,-0.10328151285648346,0.013721892610192299,-0.10030360519886017,-0.2524280548095703,0.07904182374477386,-0.4293254613876343,0.30346551537513733,0.07798035442829132,-0.01933874934911728,-0.40637415647506714,-0.03227224573493004,0.43122023344039917,-0.289211243391037,0.1231008917093277},{0.2797788381576538,-0.09156534820795059,0.1946290284395218,-0.1807056963443756,-0.6137693524360657,-0.023252859711647034,-0.12106554210186005,-0.18466678261756897,-0.2787466049194336,0.25162607431411743,0.17561042308807373,0.0913265123963356,0.6973018050193787,-0.14642271399497986,-0.2564210891723633,0.14479060471057892},{0.36326783895492554,0.14791759848594666,0.6356242299079895,0.0022407483775168657,-0.2644006907939911,0.8240711688995361,-0.24632833898067474,-0.44955509901046753,-0.8340433835983276,-0.20948679745197296,-0.20551995933055878,1.1040306091308594,0.7849606871604919,-0.21016579866409302,-0.32070478796958923,-0.10725759714841843},{0.6303026080131531,-0.3724191188812256,0.44933074712753296,-0.775253176689148,-0.7691092491149902,-0.30675700306892395,0.04690646007657051,-0.6430440545082092,0.6314036846160889,0.3866649866104126,-0.1392953097820282,-0.7157337665557861,0.6921430826187134,0.2883394658565521,0.10569317638874054,0.3238658905029297}};
static const float mlp_6_weight[16][3] = {{-0.7114591598510742,0.9171078205108643,-0.3379376232624054},{0.7473440170288086,-0.15866179764270782,1.0397491455078125},{-0.9207671284675598,0.5549375414848328,0.3211851418018341},{0.7828702330589294,-1.3035213947296143,-0.1406908929347992},{1.500012755393982,-0.6636537909507751,0.010488804429769516},{0.30447861552238464,-0.02854316495358944,-0.34039998054504395},{-0.40784308314323425,-0.8590546250343323,-0.5514664649963379},{0.7166897654533386,0.6448702812194824,-0.1863144487142563},{-0.433228462934494,1.0017189979553223,0.03259103745222092},{-0.21559719741344452,0.8314334750175476,-0.18308940529823303},{0.0953121930360794,0.809937596321106,-0.15724000334739685},{0.5754439830780029,-0.8113029599189758,-0.882140040397644},{-1.732662558555603,-0.23352472484111786,0.1525975912809372},{-0.7897418737411499,-0.7347795963287354,0.35017797350883484},{0.67559814453125,0.887398362159729,-1.4424999952316284},{-1.1075029373168945,-0.6287170052528381,-1.612790584564209}};
static const float mlp_0_bias[16] = {0.41713830828666687,0.03307367116212845,0.09675765037536621,-0.2618824541568756,0.5778248906135559,0.3289429545402527,0.20172110199928284,-0.08341214060783386,-0.037193138152360916,-0.2764981687068939,-0.04586995020508766,0.10424523800611496,-0.16870635747909546,-0.1683727204799652,-0.14729474484920502,-0.21891508996486664};
static const float mlp_2_bias[16] = {-0.030594386160373688,-0.17790132761001587,-0.016616344451904297,-0.029522299766540527,1.1972497701644897,0.29770830273628235,0.0034076934680342674,-0.0746157094836235,-0.12797319889068604,0.05684738978743553,0.21755877137184143,-0.05232046917080879,0.1857077181339264,0.2962300181388855,-0.334163099527359,0.2536161243915558};
static const float mlp_4_bias[16] = {-0.150300994515419,-0.17387379705905914,-0.023398783057928085,0.30065256357192993,0.07091512531042099,0.23983627557754517,0.004512728191912174,0.16422833502292633,0.22834111750125885,-0.344899445772171,-0.08430131524801254,0.25016456842422485,-0.07276543974876404,-0.048578210175037384,0.12488396465778351,0.15720641613006592};
static const float mlp_6_bias[3] = {0.044748105108737946,0.03759506717324257,0.08661577105522156};

void networkEvaluate(struct struct *nn_output , const float *state_array) {
    for (int i = 0; i < structure[0][1]; i++) {
        output_0[i] = 0;
        for (int j = 0; j < structure[0][0]; j++) {
            output_0[i] += state_array[j] * mlp_0_weight[j][i];
        }
        output_0[i] += mlp_0_bias[i];
        output_0[i] = tanhf(output_0[i]);
    }
    
    for (int i = 0; i < structure[1][1]; i++) {
        output_1[i] = 0;
        for (int j = 0; j < structure[1][0]; j++) {
            output_1[i] += output_0[j] * mlp_2_weight[j][i];
        }
        output_1[i] += mlp_2_bias[i];
        output_1[i] = tanhf(output_1[i]);
    }
    
    for (int i = 0; i < structure[2][1]; i++) {
        output_2[i] = 0;
        for (int j = 0; j < structure[2][0]; j++) {
            output_2[i] += output_1[j] * mlp_4_weight[j][i];
        }
        output_2[i] += mlp_4_bias[i];
        output_2[i] = tanhf(output_2[i]);
    }
    
    for (int i = 0; i < structure[3][1]; i++) {
        output_3[i] = 0;
        for (int j = 0; j < structure[3][0]; j++) {
            output_3[i] += output_2[j] * mlp_6_weight[j][i];
        }
        output_3[i] += mlp_6_bias[i];
    }
    
    nn_output->out_0 = output_3[0];
    nn_output->out_1 = output_3[1];
    nn_output->out_2 = output_3[2];
}